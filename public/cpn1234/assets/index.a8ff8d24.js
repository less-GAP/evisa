import{R as Q,p as u,r as s,o,c as r,e as v,a as t,w as i,v as p,L as W,z as S,u as _,d as w,U as X,V as G,F as A,W as D,t as V,X as J,Q as Y,H as Z,A as I,C as ee,D as te,_ as ae}from"./index.e9f28c59.js";import{U as le}from"./InputUpload.vue_vue_type_script_lang.0f5c8a09.js";const B=a=>(ee("data-v-98fb67ef"),a=a(),te(),a),ne={class:"relative text-center overflow-x-auto sm:rounded-lg"},oe=["loading"],ie=B(()=>v("span",null,null,-1)),se={class:"mt-12 mb-12 grid grid-cols-2 md:grid-cols-6 gap-4"},re={class:"cursor-pointer border-2 border-gray-100 hover:border-blue-700 h-[150px] mb-5 rounded-lg overflow:hidden"},ue=["onClick"],ce=["title","src"],de=["title"],pe={class:"absolute whitespace-nowrap text-center overflow-hidden text-ellipsis -bottom-[40px] bg-white w-full pl-2 pr-2"},fe=B(()=>v("br",null,null,-1)),me={key:0},ge={key:1},_e={__name:"FileManager",props:{config:{type:Object,default:{item_key:"id",rowSelect:!0}},pagination:{type:Object,default:{page:1,total:0,perPage:24}},showSizeChanger:{type:Boolean,default:!0},params:{type:Object,default:{}},columns:Array,selectionActions:{type:Array,default:[]},itemActions:{type:Array,default:[]},addAction:Function},setup(a){const f=a,U={item_key:"id",rowSelect:!0,globalSearch:!0,...f.config},h=u({}),c=u([]),F=u("");function m(){b.value=!0,I.get("file/list",{params:{perPage:f.pagination.perPage,page:f.pagination.page,...f.params,"filter[search]":F.value}}).then(l=>{var n;h.value=l.data,f.pagination.total=(n=l.data)!=null&&n.total?l.data.total:0}).finally(()=>{N.value=!1,b.value=!1})}const b=u(!1),N=u(!1),x=u(null);u([]);const k=u([]);async function R(l){const n=k.value.map(g=>g[U.item_key]);await l.action(n,k.value),l.complete&&l.complete(),k.value=[],m()}async function j(){if(!c.value.length)return;const l=c.value.length-1,n=c.value[l];let g=new FormData;g.append("file",n.file);const d=await I.post("file/Upload",g,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(y){c.value[l].percent=Math.round(y.loaded*100/y.total)}});h.value.data||(h.value.data=[]),c.value.splice(l,1),h.value.data.unshift(d.data),await j()}async function z(l){l.percent=0,c.value.push(l),await j()}function $(l){return/\.(jpg|jpeg|png|webp|avif|gif|svg)$/.test(l)}return m(),(l,n)=>{var P;const g=s("a-input"),d=s("a-button"),y=s("a-upload"),O=s("a-space"),K=s("a-menu-item"),L=s("a-menu"),T=s("a-dropdown"),M=s("a-progress"),q=s("a-pagination"),H=s("FileViewDetail"),E=s("a-drawer");return o(),r(A,null,[v("div",ne,[v("div",{loading:b.value,class:"flex items-center justify-between bg-white dark:bg-gray-800"},[t(O,null,{default:i(()=>[U.globalSearch?(o(),p(g,{key:0,"allow-clear":"",onKeyup:W(m,["enter"]),style:{"max-width":"300px"},value:F.value,"onUpdate:value":n[0]||(n[0]=e=>F.value=e),placeholder:"Enter to search...",loading:b.value},null,8,["onKeyup","value","loading"])):S("",!0),t(y,{name:"file",showUploadList:!1,"max-count":10,multiple:"true",customRequest:z},{default:i(()=>[t(d,null,{default:i(()=>[t(_(le)),w(" Click to Upload ")]),_:1})]),_:1}),t(y,{showUploadList:!1,customRequest:z,directory:""},{default:i(()=>[t(d,null,{default:i(()=>[t(_(X)),w(" Upload Directory ")]),_:1})]),_:1})]),_:1}),ie,t(O,null,{default:i(()=>[t(d,null,{icon:i(()=>[t(_(G),{onClick:m})]),_:1}),a.selectionActions.length>0?(o(),p(T,{key:0,disabled:!k.value.length},{overlay:i(()=>[t(L,null,{default:i(()=>[(o(!0),r(A,null,D(a.selectionActions,(e,C)=>(o(),p(K,{onClick:he=>R(e),key:C},{default:i(()=>[w(V(e.title),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),default:i(()=>[t(d,null,{default:i(()=>[w(" H\xE0nh \u0111\u1ED9ng "),t(_(J))]),_:1})]),_:1},8,["disabled"])):S("",!0),a.addAction?(o(),p(d,{key:1,type:"primary",onClick:n[1]||(n[1]=()=>{a.addAction(m)})},{default:i(()=>[w("Th\xEAm m\u1EDBi")]),_:1})):S("",!0)]),_:1})],8,oe),v("div",se,[(o(!0),r(A,null,D(c.value,e=>(o(),r("div",re,[t(M,{type:"circle",percent:e.percent},null,8,["percent"])]))),256)),(o(!0),r(A,null,D(h.value.data,e=>(o(),r("div",{onClick:C=>x.value=e,key:e.id,class:"cursor-pointer relative border-2 border-gray-100 hover:border-blue-700 h-[150px] mb-[50px] rounded-lg overflow:hidden"},[$(e.file_url)?(o(),r("img",{key:0,style:{"max-width":"auto","max-height":"auto"},title:e.file_name,class:"h-full object-contain object-center w-full max-w-full",src:e.file_url},null,8,ce)):(o(),r("div",{key:1,title:e.file_name,class:"h-full flex items-center text-center object-contain object-center w-full max-w-full"},[t(_(Y),{style:{margin:"0 auto","font-size":"30px"}})],8,de)),v("div",pe,V(e.file_name),1)],8,ue))),128))]),fe,(P=a.pagination)!=null&&P.total?(o(),p(q,{key:0,showSizeChanger:a.showSizeChanger,onChange:m,current:a.pagination.page,"onUpdate:current":n[2]||(n[2]=e=>a.pagination.page=e),pageSize:a.pagination.perPage,"onUpdate:pageSize":n[3]||(n[3]=e=>a.pagination.perPage=e),total:a.pagination.total},{itemRender:i(({type:e,originalElement:C})=>[e==="prev"?(o(),r("a",me,"Previous")):e==="next"?(o(),r("a",ge,"Next")):(o(),p(Z(C),{key:2}))]),_:1},8,["showSizeChanger","current","pageSize","total"])):S("",!0)]),t(E,{style:{"max-width":"100vw"},appendTo:"body",open:x.value,"onUpdate:open":n[4]||(n[4]=e=>x.value=e),class:"custom-class",width:"800px",title:"File Detail",placement:"right"},{default:i(()=>[t(H,{value:x.value},null,8,["value"])]),_:1},8,["open"])],64)}}},ve=Q(_e,[["__scopeId","data-v-98fb67ef"]]),be={__name:"index",setup(a){return u({visible:!1,value:null,success:()=>{},cancel:()=>{}}),u([]),(f,U)=>(o(),p(ae,null,{default:i(()=>[t(_(ve))]),_:1}))}};export{be as default};
